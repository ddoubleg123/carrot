<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard — Techpulse</title>
  <link rel="stylesheet" href="../styles.css" />
  <link rel="icon" href="../assets/favicon-wrench.svg" type="image/svg+xml" />
  <style>
    :root { --ink:#0B0B0F; --surface:#111318; --line:#1F2329; --text:#E6E8EC; --muted:#A1A7B0; --accent:#0A5AFF; }
    body { margin:0; background: var(--ink); color:#fff; }
    .shell { min-height: 100dvh; }
    .flex { display:flex; }
    /* Sidebar */
    .sidebar { position: sticky; top:0; height:100dvh; display:none; flex-direction:column; border-right:1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.02); backdrop-filter: blur(6px); }
    @media (min-width: 768px){ .sidebar { display:flex; width: 18rem; } }
    .sb-header { display:none; }
    .sb-mark { display:none; }
    .navwrap { padding: 8px; }
    .navlist { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:4px; }
    .nav a { position:relative; display:grid; grid-template-columns: 24px 1fr; align-items:center; gap:12px; border-radius: 12px; padding: 8px 12px; text-decoration:none; color: rgba(255,255,255,0.8); }
    .nav a:hover, .nav a:focus-visible { background: rgba(255,255,255,0.06); outline:none; box-shadow: 0 0 0 2px rgba(10,90,255,0.45); color:#fff; }
    .nav a[aria-current="page"] { background: rgba(255,255,255,0.08); color:#fff; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1); }
    .ico { pointer-events:none; display:grid; place-items:center; height:20px; width:20px; }
    .nav svg { width:20px; height:20px; color: rgba(255,255,255,0.6); }
    .nav a:hover svg, .nav a:focus-visible svg { color:#fff; }
    /* Active left accent bar */
    .nav a[aria-current="page"] .activebar { position:absolute; left:0; top:6px; bottom:6px; width:2px; border-radius:999px; background: rgba(10,90,255,0.8); }
    .label { min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; line-height:20px; }
    .divider { margin: 12px 12px; height:1px; background: rgba(255,255,255,0.1); }
    .sb-bottom { margin-top:auto; padding:12px; }
    .profile { border:1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); border-radius: 12px; padding: 10px; }
    .row { display:flex; align-items:center; gap:10px; }
    .avatar { height:36px; width:36px; border-radius:999px; background: rgba(255,255,255,0.1); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1); display:grid; place-items:center; font-weight:700; color:#fff; }
    .email { color: rgba(255,255,255,0.6); font-size:12px; }
    .btns { display:flex; gap:8px; margin-top:8px; }
    .btn { flex:1; border-radius: 10px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.02); color:#fff; padding: 8px 10px; font-weight:600; }
    .btn:hover, .btn:focus-visible { background: rgba(255,255,255,0.06); outline:none; box-shadow: 0 0 0 2px rgba(10,90,255,0.45); }
    .danger:hover { background: rgba(239,68,68,0.12); border-color: rgba(239,68,68,0.35); }

    /* Content */
    .content { flex:1; }
    .container { margin-inline:auto; max-width: 88rem; padding: 24px 16px; }
    @media (min-width: 768px){ .container { padding: 32px; } }
    .topbar { margin-bottom: 16px; display:flex; align-items:center; justify-content:space-between; }
    .hamb { display:inline-flex; height:40px; width:40px; align-items:center; justify-content:center; border-radius:10px; border:1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.04); }
    .title { min-width:0; }
    .title h1 { margin:0; font-size: clamp(20px, 3vw, 28px); font-weight: 700; letter-spacing: -0.01em; }
    .title p { margin:4px 0 0; color: rgba(255,255,255,0.6); font-size: 14px; }

    /* Drawer (mobile) */
    .drawer { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display:none; }
    .drawer.open { display:block; }
    .drawer .panel { position:absolute; left:0; top:0; bottom:0; width: 18rem; background: rgba(17,19,24,0.98); border-right:1px solid rgba(255,255,255,0.1); padding-top:8px; }
    /* Brand tile in sidebar */
    .brandbox { width:44px; aspect-ratio:1/1; border-radius:12px; background:#0A5AFF; display:grid; place-items:center; box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset, 0 8px 24px rgba(10,90,255,0.16); }
    .brandrow { display:flex; align-items:center; padding: 12px; padding-bottom: 8px; }
    .brand-item { margin-bottom: 12px; }
    .brandbox svg { width:60%; height:60%; color:#fff; }
  </style>
</head>
<body>
  <main class="shell bg-[#0B0B0F] text-white">
    <div class="flex">
      <!-- Sidebar (desktop) -->
      <aside class="sidebar" role="navigation" aria-label="Sidebar">
        <div class="navwrap">
          <nav class="nav">
            <ul class="navlist">
              <li class="brand-item">
                <div class="brandrow">
                  <div class="brandbox" aria-label="Techpulse mark">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 13l4-4 3 7 4-12 4 12 3-3"/></svg>
                  </div>
                </div>
              </li>
              <li aria-hidden="true"><div class="divider"></div></li>
              <li>
                <a href="#" id="nav-synth" aria-current="page">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="14" rx="2" ry="2"/><path d="M7 8h10M7 12h8"/></svg></span>
                  <span class="label">Synth</span>
                  <span aria-hidden="true" class="activebar"></span>
                </a>
              </li>
              <li>
                <a href="/chat/" id="nav-chat">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg></span>
                  <span class="label">Chat</span>
                </a>
              </li>
              <li>
                <a href="#" id="nav-edu">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10L12 4 2 10l10 6 10-6z"/><path d="M6 12v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5"/></svg></span>
                  <span class="label">Education</span>
                </a>
              </li>
              <li>
                <a href="#" id="nav-billing">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/></svg></span>
                  <span class="label">Billing</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
        <div class="divider" aria-hidden="true"></div>
        <div class="sb-bottom">
          <div class="profile">
            <div class="row">
              <div id="avatar" class="avatar" aria-hidden="true">TP</div>
              <div>
                <div id="prof-name" style="font-weight:600;">User</div>
                <div id="prof-email" class="email">user@example.com</div>
              </div>
            </div>
            <div class="btns">
              <button id="btn-account" class="btn" type="button">Account</button>
              <button id="logoutBtn" class="btn danger" type="button">Log out</button>
            </div>
          </div>
        </div>
      </aside>

      <!-- Content -->
      <section class="content">
        <div class="container">
          <div class="topbar">
            <button id="openDrawer" class="hamb md:hidden" aria-label="Open menu"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
            <div class="title">
              <h1>Dashboard</h1>
              <p>Welcome back.</p>
            </div>
          </div>
          <div class="card" style="border:1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.03); border-radius: 16px; padding: 18px;">
            <p class="email">We’ll add content panes next. Use the sidebar to navigate.</p>
          </div>
        </div>
      </section>
    </div>

    <!-- Mobile drawer -->
    <div id="drawer" class="drawer" aria-hidden="true">
      <div class="panel" role="dialog" aria-label="Navigation">
        <div class="navwrap">
          <nav class="nav">
            <ul class="navlist">
              <li>
                <div class="grid grid-cols-[24px_1fr] items-center gap-3 px-3 py-2">
                  <span class="ico">
                    <div class="brandbox" aria-label="Techpulse mark">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 13l4-4 3 7 4-12 4 12 3-3"/></svg>
                    </div>
                  </span>
                  <span class="label" aria-hidden="true"></span>
                </div>
              </li>
              <li aria-hidden="true"><div class="divider"></div></li>
              <li>
                <a href="#" aria-current="page">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="14" rx="2" ry="2"/><path d="M7 8h10M7 12h8"/></svg></span>
                  <span class="label">Synth</span>
                </a>
              </li>
              <li>
                <a href="/chat/">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg></span>
                  <span class="label">Chat</span>
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10L12 4 2 10l10 6 10-6z"/><path d="M6 12v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5"/></svg></span>
                  <span class="label">Education</span>
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/></svg></span>
                  <span class="label">Billing</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
        <div class="divider"></div>
        <div class="sb-bottom">
          <div class="profile">
            <div class="row">
              <div class="avatar">TP</div>
              <div>
                <div id="m-name" style="font-weight:600;">User</div>
                <div id="m-email" class="email">user@example.com</div>
              </div>
            </div>
            <div class="btns">
              <button class="btn" type="button">Account</button>
              <button id="m-logout" class="btn danger" type="button">Log out</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

    // Same config as login
    const firebaseConfig = {
      apiKey: "AIzaSyBmdK_8bVKr--qgJ8cPGqCX3m8QS5EkMPg",
      authDomain: "techpulse-78421.firebaseapp.com",
      projectId: "techpulse-78421",
      appId: "1:416281156741:web:c8c6da13d20b17c4a1ddec",
      storageBucket: "techpulse-78421.firebasestorage.app",
      messagingSenderId: "416281156741"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Protect route
    onAuthStateChanged(auth, (user) => {
      if (!user) { window.location.href = "/login/"; return; }
      // Populate profile
      const name = user.displayName || (user.email ? user.email.split('@')[0] : 'User');
      const initials = name.split(' ').map(s=>s[0]).join('').slice(0,2).toUpperCase();
      document.getElementById('avatar').textContent = initials;
      document.getElementById('prof-name').textContent = name;
      document.getElementById('prof-email').textContent = user.email || '';
      const mName = document.getElementById('m-name'); if (mName) mName.textContent = name;
      const mEmail = document.getElementById('m-email'); if (mEmail) mEmail.textContent = user.email || '';
    });

    // Logout buttons
    document.getElementById('logoutBtn').addEventListener('click', async () => { try { await signOut(auth); window.location.href='/login/'; } catch(e){} });
    const mLogout = document.getElementById('m-logout'); if (mLogout) mLogout.addEventListener('click', async () => { try { await signOut(auth); window.location.href='/login/'; } catch(e){} });

    // Drawer controls
    const drawer = document.getElementById('drawer');
    const openBtn = document.getElementById('openDrawer');
    openBtn.addEventListener('click', ()=> { drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); });
    drawer.addEventListener('click', (e)=> { if (e.target === drawer) { drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); } });
    window.addEventListener('keydown', (e)=> { if (e.key==='Escape') { drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); } });
  </script>
</body>
</html>
